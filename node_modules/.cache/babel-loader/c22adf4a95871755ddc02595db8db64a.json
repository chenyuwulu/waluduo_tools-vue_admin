{"remainingRequest":"D:\\we_sub\\gf-vue-admin\\web\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js!D:\\we_sub\\gf-vue-admin\\web\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js??ref--13-0!D:\\we_sub\\gf-vue-admin\\web\\src\\utils\\request.js","dependencies":[{"path":"D:\\we_sub\\gf-vue-admin\\web\\src\\utils\\request.js","mtime":1601342948868},{"path":"D:\\we_sub\\gf-vue-admin\\web\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\we_sub\\gf-vue-admin\\web\\node_modules\\_babel-loader@8.1.0@babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\we_sub\\gf-vue-admin\\web\\node_modules\\_eslint-loader@2.2.1@eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7IC8vIOW8leWFpWF4aW9zCgppbXBvcnQgeyBNZXNzYWdlLCBMb2FkaW5nIH0gZnJvbSAnZWxlbWVudC11aSc7CmltcG9ydCB7IHN0b3JlIH0gZnJvbSAnQC9zdG9yZS9pbmRleCc7CnZhciBzZXJ2aWNlID0gYXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJLAogIHRpbWVvdXQ6IDk5OTk5Cn0pOwp2YXIgYWNpdHZlQXhpb3MgPSAwOwp2YXIgbG9hZGluZ0luc3RhbmNlOwp2YXIgdGltZXI7Cgp2YXIgc2hvd0xvYWRpbmcgPSBmdW5jdGlvbiBzaG93TG9hZGluZygpIHsKICBhY2l0dmVBeGlvcysrOwoKICBpZiAodGltZXIpIHsKICAgIGNsZWFyVGltZW91dCh0aW1lcik7CiAgfQoKICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgaWYgKGFjaXR2ZUF4aW9zID4gMCkgewogICAgICBsb2FkaW5nSW5zdGFuY2UgPSBMb2FkaW5nLnNlcnZpY2UoewogICAgICAgIGZ1bGxzY3JlZW46IHRydWUKICAgICAgfSk7CiAgICB9CiAgfSwgNDAwKTsKfTsKCnZhciBjbG9zZUxvYWRpbmcgPSBmdW5jdGlvbiBjbG9zZUxvYWRpbmcoKSB7CiAgYWNpdHZlQXhpb3MtLTsKCiAgaWYgKGFjaXR2ZUF4aW9zIDw9IDApIHsKICAgIGNsZWFyVGltZW91dCh0aW1lcik7CiAgICBsb2FkaW5nSW5zdGFuY2UgJiYgbG9hZGluZ0luc3RhbmNlLmNsb3NlKCk7CiAgfQp9OyAvL2h0dHAgcmVxdWVzdCDmi6bmiKrlmagKCgpzZXJ2aWNlLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgc2hvd0xvYWRpbmcoKTsKICB2YXIgdG9rZW4gPSBzdG9yZS5nZXR0ZXJzWyd1c2VyL3Rva2VuJ107CiAgdmFyIHVzZXIgPSBzdG9yZS5nZXR0ZXJzWyd1c2VyL3VzZXJJbmZvJ107CiAgY29uZmlnLmRhdGEgPSBKU09OLnN0cmluZ2lmeShjb25maWcuZGF0YSk7CiAgY29uZmlnLmhlYWRlcnMgPSB7CiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgJ0F1dGhvcml6YXRpb24nOiAiQmVhcmVyICIgKyB0b2tlbiwKICAgICd4LXVzZXItaWQnOiB1c2VyLklECiAgfTsKICByZXR1cm4gY29uZmlnOwp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICBjbG9zZUxvYWRpbmcoKTsKICBNZXNzYWdlKHsKICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgIG1lc3NhZ2U6IGVycm9yLAogICAgdHlwZTogJ2Vycm9yJwogIH0pOwogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOyAvL2h0dHAgcmVzcG9uc2Ug5oum5oiq5ZmoCgpzZXJ2aWNlLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgY2xvc2VMb2FkaW5nKCk7CgogIGlmIChyZXNwb25zZS5oZWFkZXJzWyJuZXctdG9rZW4iXSkgewogICAgc3RvcmUuY29tbWl0KCd1c2VyL3NldFRva2VuJywgcmVzcG9uc2UuaGVhZGVyc1sibmV3LXRva2VuIl0pOwogIH0KCiAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PSAwIHx8IHJlc3BvbnNlLmhlYWRlcnMuc3VjY2VzcyA9PT0gInRydWUiKSB7CiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICB9IGVsc2UgewogICAgTWVzc2FnZSh7CiAgICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgICAgbWVzc2FnZTogcmVzcG9uc2UuZGF0YS5tc2cgfHwgZGVjb2RlVVJJKHJlc3BvbnNlLmhlYWRlcnMubXNnKSwKICAgICAgdHlwZTogJ2Vycm9yJwogICAgfSk7CgogICAgaWYgKHJlc3BvbnNlLmRhdGEuZGF0YSAmJiByZXNwb25zZS5kYXRhLmRhdGEucmVsb2FkKSB7CiAgICAgIHN0b3JlLmNvbW1pdCgndXNlci9Mb2dpbk91dCcpOwogICAgfQoKICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZS5kYXRhLm1zZyk7CiAgfQp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICBjbG9zZUxvYWRpbmcoKTsKICBNZXNzYWdlKHsKICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgIG1lc3NhZ2U6IGVycm9yLAogICAgdHlwZTogJ2Vycm9yJwogIH0pOwogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOwpleHBvcnQgZGVmYXVsdCBzZXJ2aWNlOw=="},{"version":3,"sources":["D:/we_sub/gf-vue-admin/web/src/utils/request.js"],"names":["axios","Message","Loading","store","service","create","baseURL","process","env","VUE_APP_BASE_API","timeout","acitveAxios","loadingInstance","timer","showLoading","clearTimeout","setTimeout","fullscreen","closeLoading","close","interceptors","request","use","config","token","getters","user","data","JSON","stringify","headers","ID","error","showClose","message","type","Promise","reject","response","commit","code","success","msg","decodeURI","reload"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB,C,CAA2B;;AAC3B,SAASC,OAAT,EAAkBC,OAAlB,QAAiC,YAAjC;AACA,SAASC,KAAT,QAAsB,eAAtB;AACA,IAAMC,OAAO,GAAGJ,KAAK,CAACK,MAAN,CAAa;AACzBC,EAAAA,OAAO,EAAEC,OAAO,CAACC,GAAR,CAAYC,gBADI;AAEzBC,EAAAA,OAAO,EAAE;AAFgB,CAAb,CAAhB;AAIA,IAAIC,WAAW,GAAG,CAAlB;AACA,IAAIC,eAAJ;AACA,IAAIC,KAAJ;;AACA,IAAMC,WAAW,GAAG,SAAdA,WAAc,GAAM;AACtBH,EAAAA,WAAW;;AACX,MAAIE,KAAJ,EAAW;AACPE,IAAAA,YAAY,CAACF,KAAD,CAAZ;AACH;;AACDA,EAAAA,KAAK,GAAGG,UAAU,CAAC,YAAM;AACrB,QAAIL,WAAW,GAAG,CAAlB,EAAqB;AACjBC,MAAAA,eAAe,GAAGV,OAAO,CAACE,OAAR,CAAgB;AAAEa,QAAAA,UAAU,EAAE;AAAd,OAAhB,CAAlB;AACH;AACJ,GAJiB,EAIf,GAJe,CAAlB;AAKH,CAVD;;AAYA,IAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;AACnBP,EAAAA,WAAW;;AACX,MAAIA,WAAW,IAAI,CAAnB,EAAsB;AAClBI,IAAAA,YAAY,CAACF,KAAD,CAAZ;AACAD,IAAAA,eAAe,IAAIA,eAAe,CAACO,KAAhB,EAAnB;AACH;AACJ,CANL,C,CAOI;;;AACJf,OAAO,CAACgB,YAAR,CAAqBC,OAArB,CAA6BC,GAA7B,CACI,UAAAC,MAAM,EAAI;AACNT,EAAAA,WAAW;AACX,MAAMU,KAAK,GAAGrB,KAAK,CAACsB,OAAN,CAAc,YAAd,CAAd;AACA,MAAMC,IAAI,GAAGvB,KAAK,CAACsB,OAAN,CAAc,eAAd,CAAb;AACAF,EAAAA,MAAM,CAACI,IAAP,GAAcC,IAAI,CAACC,SAAL,CAAeN,MAAM,CAACI,IAAtB,CAAd;AACAJ,EAAAA,MAAM,CAACO,OAAP,GAAiB;AACb,oBAAgB,kBADH;AAEb,qBAAiB,YAAYN,KAFhB;AAGb,iBAAaE,IAAI,CAACK;AAHL,GAAjB;AAKA,SAAOR,MAAP;AACH,CAZL,EAaI,UAAAS,KAAK,EAAI;AACLd,EAAAA,YAAY;AACZjB,EAAAA,OAAO,CAAC;AACJgC,IAAAA,SAAS,EAAE,IADP;AAEJC,IAAAA,OAAO,EAAEF,KAFL;AAGJG,IAAAA,IAAI,EAAE;AAHF,GAAD,CAAP;AAKA,SAAOC,OAAO,CAACC,MAAR,CAAeL,KAAf,CAAP;AACH,CArBL,E,CAyBA;;AACA5B,OAAO,CAACgB,YAAR,CAAqBkB,QAArB,CAA8BhB,GAA9B,CACI,UAAAgB,QAAQ,EAAI;AACRpB,EAAAA,YAAY;;AACZ,MAAIoB,QAAQ,CAACR,OAAT,CAAiB,WAAjB,CAAJ,EAAmC;AAC/B3B,IAAAA,KAAK,CAACoC,MAAN,CAAa,eAAb,EAA8BD,QAAQ,CAACR,OAAT,CAAiB,WAAjB,CAA9B;AACH;;AACD,MAAIQ,QAAQ,CAACX,IAAT,CAAca,IAAd,IAAsB,CAAtB,IAA2BF,QAAQ,CAACR,OAAT,CAAiBW,OAAjB,KAA6B,MAA5D,EAAoE;AAChE,WAAOH,QAAQ,CAACX,IAAhB;AACH,GAFD,MAEO;AACH1B,IAAAA,OAAO,CAAC;AACJgC,MAAAA,SAAS,EAAE,IADP;AAEJC,MAAAA,OAAO,EAAEI,QAAQ,CAACX,IAAT,CAAce,GAAd,IAAqBC,SAAS,CAACL,QAAQ,CAACR,OAAT,CAAiBY,GAAlB,CAFnC;AAGJP,MAAAA,IAAI,EAAE;AAHF,KAAD,CAAP;;AAKA,QAAIG,QAAQ,CAACX,IAAT,CAAcA,IAAd,IAAsBW,QAAQ,CAACX,IAAT,CAAcA,IAAd,CAAmBiB,MAA7C,EAAqD;AACjDzC,MAAAA,KAAK,CAACoC,MAAN,CAAa,eAAb;AACH;;AACD,WAAOH,OAAO,CAACC,MAAR,CAAeC,QAAQ,CAACX,IAAT,CAAce,GAA7B,CAAP;AACH;AACJ,CAnBL,EAoBI,UAAAV,KAAK,EAAI;AACLd,EAAAA,YAAY;AACZjB,EAAAA,OAAO,CAAC;AACJgC,IAAAA,SAAS,EAAE,IADP;AAEJC,IAAAA,OAAO,EAAEF,KAFL;AAGJG,IAAAA,IAAI,EAAE;AAHF,GAAD,CAAP;AAKA,SAAOC,OAAO,CAACC,MAAR,CAAeL,KAAf,CAAP;AACH,CA5BL;AA+BA,eAAe5B,OAAf","sourcesContent":["import axios from 'axios'; // 引入axios\r\nimport { Message, Loading } from 'element-ui';\r\nimport { store } from '@/store/index'\r\nconst service = axios.create({\r\n    baseURL: process.env.VUE_APP_BASE_API,\r\n    timeout: 99999\r\n})\r\nlet acitveAxios = 0\r\nlet loadingInstance\r\nlet timer\r\nconst showLoading = () => {\r\n    acitveAxios++\r\n    if (timer) {\r\n        clearTimeout(timer)\r\n    }\r\n    timer = setTimeout(() => {\r\n        if (acitveAxios > 0) {\r\n            loadingInstance = Loading.service({ fullscreen: true })\r\n        }\r\n    }, 400);\r\n}\r\n\r\nconst closeLoading = () => {\r\n        acitveAxios--\r\n        if (acitveAxios <= 0) {\r\n            clearTimeout(timer)\r\n            loadingInstance && loadingInstance.close()\r\n        }\r\n    }\r\n    //http request 拦截器\r\nservice.interceptors.request.use(\r\n    config => {\r\n        showLoading()\r\n        const token = store.getters['user/token']\r\n        const user = store.getters['user/userInfo']\r\n        config.data = JSON.stringify(config.data);\r\n        config.headers = {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': \"Bearer \" + token,\r\n            'x-user-id': user.ID\r\n        }\r\n        return config;\r\n    },\r\n    error => {\r\n        closeLoading()\r\n        Message({\r\n            showClose: true,\r\n            message: error,\r\n            type: 'error'\r\n        })\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\n\r\n//http response 拦截器\r\nservice.interceptors.response.use(\r\n    response => {\r\n        closeLoading()\r\n        if (response.headers[\"new-token\"]) {\r\n            store.commit('user/setToken', response.headers[\"new-token\"])\r\n        }\r\n        if (response.data.code == 0 || response.headers.success === \"true\") {\r\n            return response.data\r\n        } else {\r\n            Message({\r\n                showClose: true,\r\n                message: response.data.msg || decodeURI(response.headers.msg),\r\n                type: 'error',\r\n            })\r\n            if (response.data.data && response.data.data.reload) {\r\n                store.commit('user/LoginOut')\r\n            }\r\n            return Promise.reject(response.data.msg)\r\n        }\r\n    },\r\n    error => {\r\n        closeLoading()\r\n        Message({\r\n            showClose: true,\r\n            message: error,\r\n            type: 'error'\r\n        })\r\n        return Promise.reject(error)\r\n    }\r\n)\r\n\r\nexport default service"]}]}